---
title: "Beveiligde Robotica Afstandsbediening: Robonomics Oplossing"
date: 2024-04-19
published: true
locale: 'nl'
cover_image: /blog/images/secure-robotics-remote-control-via-web3/remote_control_cover.png
description: "Een externe verbinding en bediening van je eigen slimme apparaat is een zeer populaire functie onder gebruikers. Toch veroorzaakt zo'n triviale taak nog steeds veel moeilijkheden voor onervaren gebruikers - van het overwinnen van NAT tot beveiligingsproblemen. In een nieuw artikel laten we zien hoe deze moeilijkheden overwonnen kunnen worden met behulp van Robonomics."
related: ['Robonomics Helps Enable Rust for ROS 2', 'Automation: Home meets Industrial']
abstract: "Een externe verbinding en bediening van je eigen slimme apparaat is een zeer populaire functie onder gebruikers. Toch veroorzaakt zo'n triviale taak nog steeds veel moeilijkheden voor onervaren gebruikers - van het overwinnen van NAT tot beveiligingsproblemen. In een nieuw artikel laten we zien hoe deze moeilijkheden overwonnen kunnen worden met behulp van Robonomics."
tags: ['ROS 2', 'Smart Home']
---

In het vorige artikel bespraken we hoe we de voordelen van industriële oplossingen gebruiken in de infrastructuur van een gerobotiseerd slim huis. We lieten zien hoe het ROS 2-framework en het bijbehorende middlewareprotocol automatische apparaatdetectie en intensieve interactie (ook in real-time) tussen apparaten binnen een lokaal netwerk mogelijk maken, wat erg handig is. Deze aanpak is echter vooral geschikt voor de zogenaamde Trusted Zone - dat deel van het computernetwerk waar de aanwezigheid van externe actoren onwaarschijnlijk is. In dit geval vertrouwen we alle draaiende programma's en hoeven we geen encryptie te gebruiken, net zoals dat binnen één computer niet nodig is wanneer programma's onderling gegevens uitwisselen.

Maar wat als je de werking van ROS 2-apparaten met een externe dienst wilt garanderen of externe toegang tot deze apparaten wilt bieden? Op zulke momenten ontstaat er een beveiligingsprobleem - wanneer een externe dienst (en mogelijk een kwaadwillende) toegang krijgt tot één ROS 2-node, krijgt deze in feite toegang tot alle andere nodes - hij kan al het interne DDS-verkeer volledig afluisteren en toegang krijgen tot alle beschikbare systeemdiensten.

De klassieke afweging tussen veiligheid en snelheid/gemak wordt opgelost door het soevereine slimme huissysteem op te delen in twee delen - veilig en onveilig.

## ROS 2 Beveiliging

Het aanwijzen van een zone met speciale beveiligingseisen in de werkruimte van ROS 2-nodes is een behoorlijk complexe taak. Het standaard ROS 2 Security-pakket ([sros2](https://docs.ros.org/nl/rolling/Concepts/Intermediate/About-Security.html)) maakt deel uit van [ros-core](https://ros.org/reps/rep-2001.html#id32), waarop alle ROS 2-distributies zijn gebouwd, en volgens de kernontwikkelaars is het bedoeld om dit probleem op te lossen. Het biedt de mogelijkheid om een relatief eenvoudige public key infrastructure (PKI) op te zetten binnen één lokaal netwerk. Voor elke ROS 2-node worden toegangsbeleidsregels tot de gegevens van andere nodes ingesteld, evenals een set standaardbestanden voor dergelijke scenario's - cryptografische sleutels en certificaten. Tijdens de uitvoering van het programma "zien" nodes alleen die gegevensbronnen waarvoor expliciet toegang is vastgelegd in de configuratie bij het opstarten van het project. Deze aanpak heeft echter een groot nadeel: al het verkeer in het systeem wordt versleuteld, wat de prestaties kan beïnvloeden onder de netwerkbelasting die door DDS wordt veroorzaakt. Het zal nodig zijn om alle toegangsbeleidsregels uit te schrijven en sleutels te genereren voor alle nodes. Dit is erg moeilijk op te zetten en te onderhouden. En het belangrijkste: we verliezen het grootste voordeel van ROS 2 Middleware - de prestaties.

## Bridges

Een andere oplossing is het creëren van zogenaamde gateways, die de benodigde gegevens doorgeven terwijl al het andere privé blijft. Dit wordt meestal bereikt met behulp van VPN- of SSH-tunnels. Er wordt een aparte node aangemaakt in de beveiligde gegevensuitwisselingsruimte, die een publiek adres heeft voor externe verbindingen. In dit geval wordt het beveiligingsbeheer alleen uitgevoerd op het niveau van deze node (in wezen een venster naar de buitenwereld), zonder invloed op alle andere. Deze aanpak wordt gebruikt in de projecten [Husarnet](https://github.com/husarnet/husarnet), [DDS Router](https://github.com/eProsima/DDS-Router) en [Zenoh Bridge](https://github.com/eclipse-zenoh/zenoh-plugin-ros2dds), maar ook deze heeft nadelen. In dit scenario moet je een beveiligd communicatiekanaal opzetten dat strikt is gekoppeld aan het IP-adres of domeinnaam van de tegenpartij. Deze kunnen veranderen, geblokkeerd raken of kwetsbaar zijn voor aanvallen. Toen SSH werd ontwikkeld, werd hier geen rekening mee gehouden. Bovendien vertrouwt SSH voornamelijk op het toegangscontrolesysteem van het besturingssysteem, met alle bijbehorende nadelen.

<RbImage zoom src="/blog/images/secure-robotics-remote-control-via-web3/remote_control_legacy_approach.png" alt="Klassieke afstandsbediening via publieke IP en SSH/VPN" />

*Hier is hoe gebruikers tegenwoordig meestal op afstand verbinding maken met hun robots. Deze aanpak heeft echter enkele nadelen. Er is een openbaar IP-adres en/of DNS-naam voor nodig, wat in sommige landen geblokkeerd kan worden. Ook vereist het de opslag van extra privésleutels op mogelijk onveilige locaties (bijv. ~/.ssh).*

SSH, dat voornamelijk wordt gebruikt door systeembeheerders en IT-specialisten, vereist basiskennis van de Bash-opdrachtregel en vertrouwen in het besturingssysteem, aangezien encryptiesleutels direct in het bestandssysteem of de SSH-agent worden opgeslagen. Het beheren van toegangssleutels blijft een vrij complexe taak voor de gemiddelde gebruiker om een veilige manier te blijven om hun gegevens te beschermen.

## Web3-oplossing

Zoals we kunnen zien, zijn de bovenstaande methoden niet zonder nadelen, dus zullen we een mogelijke oplossing voor het probleem overwegen met behulp van peer-to-peer-netwerktechnologieën, waarop Robonomics is gebouwd. In dit geval kan de gedecentraliseerde Robonomics-cloud worden gezien als een veilige routeringstabel, waarvan de adressen van de tegenpartijen de openbare sleutels van de nodes zijn. Je hebt een lokale Robonomics-node nodig en kennis van welke openbare sleutel je tegenpartij heeft, zodat je niet afhankelijk bent van het DNS-systeem (inclusief domeinnaamregistrars en -servers) en IP-adresblokkering. De [libP2P](https://libp2p.io/)-bibliotheek, die Robonomics gebruikt, kan verschillende transportprotocollen gebruiken voor berichtaflevering.

Bovendien zijn er met de vooruitgang van Web3-technologieën efficiëntere methoden ontstaan voor het beheren van kritieke informatie, waaronder privésleutels. Een daarvan is een mnemonische zin of seed - een reeks van 12 of 24 woorden, gebruikt om accounts aan te maken in gedecentraliseerde netwerken. Deze methode is handig en veilig, omdat de seed één keer tijdens de initialisatie op een extern medium (bijvoorbeeld op papier) wordt geschreven en alleen wordt gebruikt om het account te herstellen. Uit de mnemonische zin wordt een hoofdsleutel aangemaakt, waaruit elke gewenste sleutelhiërarchie voor verschillende taken kan worden aangemaakt (zie **[Hierarchisch deterministische sleutels](https://docs.substrate.io/reference/command-line-tools/subkey/#hierarchical-deterministic-keys)**). Dit vereenvoudigt het beheer van sleutels en het herstel ervan als ze verloren zijn gegaan. Als een kwaadwillende toegang krijgt tot een van je sleutelpaar, kan hij geen informatie verkrijgen over andere sleutels die uit de mnemonische zin zijn aangemaakt. De soft derived key-functie maakt het mogelijk om eigenaarschap van het root-account te bevestigen zonder deze prijs te geven. Omdat soft keys kunnen worden afgeleid met behulp van de ouderlijke openbare sleutel, kunnen ze worden gebruikt om de ouder te identificeren sleutel zonder de ouderlijke seed bloot te stellen.

## Afstandsbediening in Home Assistant

Laten we het verbindingsproces in meer detail bekijken. De gedecentraliseerde [Robonomics applicatie](https://robonomics.app/) (of gewoon DApp) werkt direct in je browser, je hoeft geen extra software te installeren of sleutels op te slaan in het bestandssysteem in een omgeving met veel programma's waarvan je de veiligheid niet kunt garanderen. Het beheer van toegangssleutels wordt uitgevoerd via de Polkadot JS-extensie, evenals met behulp van een externe hardware-sleutelopslag (bijvoorbeeld [Polkadot Vault](https://wiki.polkadot.network/docs/polkadot-vault)) voor extra betrouwbaarheid. Naast gespecialiseerde software voor interactie met Robonomics, bevat de DApp ook een lichte libP2P-node, waarmee de verbinding met Home Assistant tot stand wordt gebracht.

<RbImage zoom src="/blog/images/secure-robotics-remote-control-via-web3/robonomics_home_assistant_usecase.png" alt="Home Assistant Afstandsbediening" />

De eigenaar van een Robonomics Web Service-abonnement beheert toegangsrechten tot de slimme thuisinfrastructuur via een zogenaamde controller - een account dat alle gevoelige informatie in versleutelde vorm in een digitale tweeling beheert. Alleen gebruikers die aan het abonnement zijn toegevoegd, kunnen deze gegevens ontsleutelen. Naast toegangssleutels slaat de Digitale Tweeling ook de DApp-configuratie op en de zogenaamde libP2P multi-adres waarop de DApp verbinding maakt voor een beveiligde verbinding. Multi-adres is een van die innovaties die de libP2P-aanpak zo uniek en flexibel maakt. Dit is een speciaal adresformaat voor nodes, dat het bestaan van meerdere IP-adressen, transport- en netwerkidentificatoren, protocollen en poorten impliceert, waarmee je contact kunt opnemen met een specifieke node. De volledige lijst van ondersteunde protocollen is te vinden in de [specificatie](https://github.com/multiformats/multiaddr/blob/master/protocols.csv).

Dus, de gebruiker die aan het abonnement is toegevoegd, haalt een multi-adres uit de Robonomics digitale tweeling en legt een beveiligde verbinding tot stand met een Peer ID die alleen bij hem bekend is. Succes!

## Afstandsbediening in ROS 2

Op dezelfde manier kun je de bestaande functies van Robonomics gebruiken om met robots te communiceren. Het Robossembler-team heeft, onder het Robonomics Grant Program, een Proof of Concept-project ontwikkeld dat bekend staat als [Robonomics Bridge](https://gitlab.com/robossembler/robonomics_bridge). Deze bridge maakt het mogelijkje ROS 2-nodes om verbinding te maken met elke externe dienst, externe werkplek of een ander ROS 2-systeem.

<RbImage zoom src="/blog/images/secure-robotics-remote-control-via-web3/robonomics_ros2_usecase.png" alt="ROS 2 Remote Control with Robonomics" />

*Een illustratie van hoe de afstandsbediening van een huisrobot eruit zou kunnen zien in het geval van ROS 2. Deze benadering biedt een aantal belangrijke voordelen: er is geen publieke IP nodig, toegang tot de robot is mogelijk zelfs via netwerkfirewalls (NAT), privé cryptografische sleutels worden niet op schijf opgeslagen en zijn betrouwbaar beschermd.*

Het protocol dat in ROS 2 wordt gebruikt, DDS, combineert van nature met libP2P vanwege het vergelijkbare publisher-subscriber model voor node-interactie. Met behulp van de Robonomics bridge kunnen ROS 2-nodes en hun interfaces - topics, services, berichttypen (bijvoorbeeld met de eProsima Integration Service) declaratief worden geconfigureerd, waardoor interactie met de robot van buitenaf mogelijk is. Dit biedt ook een extra beveiligingslaag bij het verbinden met een externe computer. Het mechanisme voor het verkrijgen van de PeerID van de tegenpartij kan hetzelfde zijn als in het geval van Home Assistant - via een Digital Twin-verzoek van de Robonomics-node, met als enige verschil dat in plaats van de Home Assistant Server er een ROS 2-robot zal zijn, en in plaats van de libP2P-websocker-proxy er een Robonomics ROS 2 Wrapper zal zijn die met de robot is verbonden.

## Potentiële kansen in de toekomst

Dit zijn echter niet alle mogelijkheden die een gedecentraliseerde cloud op Web3-technologieën kan bieden. In het hierboven beschreven voorbeeld worden deze technologieën gebruikt voor relatief eenvoudige overdracht van berichtdatastromen tussen externe computers.

Dit kan het basistransportniveau in de Robonomics-netwerkstack worden genoemd, dat de basis vormt voor de implementatie van meer complexe protocollen op een hoger niveau. Beginnend bij SSH-analogen, die meer interactieve interactie van gebruikers met hun cyber-fysieke systemen impliceren, en eindigend bij applicatieprotocollen die de interactie van een groot aantal gebruikers van autonome robotinfrastructuur mogelijk maken.

Bijvoorbeeld, de beslissing om te starten met de productie van een bepaald product kan worden gekoppeld aan een stemming binnen een organisatie van potentiële consumenten van dit product, waarbij rekening wordt gehouden met economische haalbaarheid. Momenteel wordt de beslissing om een productie te starten genomen via investeringsmechanismen, waarbij investeerders, nadat ze informatie over de potentiële vraag hebben ontvangen, aandelen kunnen verwerven van individuele bedrijven die in de toekomst aan deze vraag kunnen voldoen.. Als consumenten actiever kunnen deelnemen aan de ontwikkeling en prijsbepaling van nieuwe producten, dan kunnen we op de lange termijn overstappen op een werkwijze waarbij de productie zich automatisch zal herstructureren om aan de vraag te voldoen op basis van door consumenten in het netwerk aangeleverde gegevens.