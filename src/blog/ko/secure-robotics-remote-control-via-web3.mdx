---
title: "로보노믹스 솔루션: 안전한 로보틱스 원격 제어"
date: 2024-04-19
published: true
locale: 'ko'
cover_image: /blog/images/secure-robotics-remote-control-via-web3/remote_control_cover.png
description: "자신의 스마트 기기를 원격으로 연결하고 제어하는 기능은 사용자들 사이에서 매우 인기 있는 기능입니다. 하지만 이러한 사소한 작업조차도 경험이 부족한 사용자들에게는 NAT 극복부터 보안 문제까지 많은 어려움을 야기합니다. 이번 글에서는 로보노믹스를 통해 이러한 어려움을 어떻게 극복할 수 있는지 보여드리겠습니다."
related: ['Robonomics Helps Enable Rust for ROS 2', 'Automation: Home meets Industrial']
abstract: "자신의 스마트 기기를 원격으로 연결하고 제어하는 기능은 사용자들 사이에서 매우 인기 있는 기능입니다. 하지만 이러한 사소한 작업조차도 경험이 부족한 사용자들에게는 NAT 극복부터 보안 문제까지 많은 어려움을 야기합니다. 이번 글에서는 로보노믹스를 통해 이러한 어려움을 어떻게 극복할 수 있는지 보여드리겠습니다."
tags: ['ROS 2', 'Smart Home']
---

이전 글에서는 로봇화된 스마트 홈 인프라에서 산업 솔루션의 장점을 어떻게 활용하는지에 대해 이야기했습니다. 우리는 ROS 2 프레임워크와 그 미들웨어 프로토콜이 자동 장치 검색과 집안의 로컬 네트워크 내에서의 실시간을 포함한 강력한 상호작용을 어떻게 제공하는지 보여주었습니다. 이는 매우 편리합니다. 하지만 이러한 접근 방식은 주로 신뢰 구역(Trusted Zone)이라고 불리는, 외부인이 등장할 가능성이 거의 없는 컴퓨터 네트워크의 일부에 적합합니다. 이 경우, 우리는 실행 중인 모든 프로그램을 신뢰하며, 한 컴퓨터 내에서 프로그램들이 서로 데이터를 교환할 때 암호화를 사용하지 않는 것처럼 암호화를 사용할 필요가 없습니다.

하지만 ROS 2 장치를 외부 서비스와 연동하거나 외부에서 원격으로 접근해야 한다면 어떻게 해야 할까요? 이럴 때 보안 문제가 발생합니다. ROS 2 노드 하나에 접근하게 되면, 외부 서비스(그리고 잠재적으로 악의적인 인물)는 사실상 모든 다른 노드에 접근할 수 있게 됩니다. 내부 DDS 트래픽을 모두 들을 수 있고, 모든 시스템 서비스에 접근할 수 있습니다.

보안과 속도/편의성 사이의 고전적인 딜레마는 자주권 스마트 홈 시스템을 안전한 부분과 안전하지 않은 부분, 두 부분으로 나누는 방식으로 해결할 수 있습니다.

## ROS 2 보안

ROS 2 노드의 작업 공간에서 특별한 보안 요구 사항이 있는 구역을 지정하는 것은 상당히 까다로운 작업입니다. 표준 ROS 2 Security 패키지([sros2](https://docs.ros.org/ko/rolling/Concepts/Intermediate/About-Security.html))는 모든 ROS 2 배포판의 기반이 되는 [ros-core](https://ros.org/reps/rep-2001.html#id32)의 일부이며, 핵심 개발자들에 따르면 이 문제를 해결하기 위해 설계되었습니다. 이는 단일 로컬 네트워크 내에서 비교적 간단한 공개 키 인프라(PKI)를 설정할 수 있는 기능을 제공합니다. 각 ROS 2 노드마다 다른 노드의 데이터에 대한 접근 정책과 그러한 시나리오를 위한 표준 파일 세트(암호화 키 및 인증서)가 설정됩니다. 프로그램 실행 중에는 노드가 프로젝트 시작 단계의 구성에 명시적으로 접근 권한이 부여된 데이터 소스만 "볼" 수 있습니다. 그러나 이 접근 방식에는 큰 단점이 있습니다. 시스템 내 모든 트래픽이 암호화되어 DDS가 생성하는 네트워크 부하 하에서 성능에 영향을 줄 수 있습니다. 모든 접근 정책을 작성하고 모든 노드에 대한 키를 생성해야 합니다. 이는 설정과 유지 관리가 매우 어렵습니다. 그리고 가장 중요한 점은 ROS 2 미들웨어의 주요 장점인 성능을 잃게 된다는 것입니다.

## 브리지

또 다른 해결책은 필요한 데이터만 전송하고 나머지는 비공개로 유지하는 이른바 게이트웨이를 만드는 것입니다. 일반적으로 이는 VPN 또는 SSH 터널을 사용하여 달성됩니다. 외부 연결을 위한 공개 주소를 가진 별도의 노드가 보안 데이터 교환 공간에 생성됩니다. 이 경우 보안 관리는 이 노드(본질적으로 외부 세계로의 창) 수준에서만 이루어지며, 다른 모든 노드에는 영향을 미치지 않습니다. 이 접근 방식은 [Husarnet](https://github.com/husarnet/husarnet), [DDS Router](https://github.com/eProsima/DDS-Router), [Zenoh Bridge](https://github.com/eclipse-zenoh/zenoh-plugin-ros2dds) 프로젝트에서 사용되지만, 단점도 있습니다. 이 시나리오에서는 상대방의 IP 주소나 도메인 이름에 엄격히 연결된 보안 통신 채널을 설정해야 합니다. 이러한 정보는 변경될 수 있고, 차단되거나 공격에 취약할 수 있습니다. SSH가 만들어졌을 당시에는 이러한 점이 고려되지 않았습니다. 또한 SSH는 주로 운영 체제의 접근 제어 시스템에 의존하며, 그에 따른 고유한 단점이 있습니다.

<RbImage zoom src="/blog/images/secure-robotics-remote-control-via-web3/remote_control_legacy_approach.png" alt="Classic Remote Control via public IP and SSH/VPN" />

*다음은 사용자가 요즘 원격으로 로봇에 연결하는 일반적인 방법입니다. 하지만 이 방식에는 몇 가지 단점이 있습니다. 공인 IP 또는/및 DNS 이름이 필요하며, 이는 일부 국가에서 차단될 수 있습니다. 또한 추가적인 개인 키를 잠재적으로 안전하지 않은 위치(예: ~/.ssh)에 저장해야 합니다.*

SSH는 주로 시스템 관리자와 IT 전문가가 사용하는데, Bash 명령줄에 대한 기본 지식과 운영 체제에 대한 신뢰가 필요합니다. 암호화 키가 파일 시스템이나 SSH 에이전트에 직접 저장되기 때문입니다. 액세스 키 관리 역시 일반 사용자에게는 여전히 복잡한 작업으로, 데이터를 안전하게 보호하기 위한 방법입니다.

## Web3 솔루션

위에서 살펴본 방법들도 단점이 없지 않으므로, Robonomics가 구축된 피어 투 피어 네트워크 기술을 활용한 문제 해결 방안을 고려해보겠습니다. 이 경우, 분산된 Robonomics 클라우드는 안전한 라우팅 테이블로 볼 수 있으며, 그 안의 상대방 주소는 노드의 공개 키입니다. 로컬 Robonomics 노드와 상대방의 공개 키만 알면 DNS 시스템(도메인 이름 등록기관 및 서버 포함)이나 IP 주소 차단에 의존하지 않아도 됩니다. Robonomics가 사용하는 [libP2P](https://libp2p.io/) 라이브러리는 메시지 전달을 위해 다양한 전송 프로토콜을 사용할 수 있습니다.

더 나아가, Web3 기술의 발전으로 개인 키 등 중요한 정보를 관리하는 보다 효율적인 방법이 등장했습니다. 그 중 하나가 니모닉 구문 또는 시드(Seed)로, 분산 네트워크에서 계정을 생성할 때 사용하는 12개 또는 24개의 단어 세트입니다. 이 방법은 초기화 시 외부 매체(예: 종이)에 한 번만 기록하고 계정 복구에만 사용되기 때문에 편리하고 안전합니다. 니모닉 구문에서 마스터 키가 생성되며, 이를 통해 다양한 작업을 위한 키 계층 구조를 만들 수 있습니다(**[계층적 결정적 키](https://docs.substrate.io/reference/command-line-tools/subkey/#hierarchical-deterministic-keys)** 참조). 이로 인해 키 관리와 분실 시 복구가 간편해집니다. 만약 악의적인 사용자가 키 쌍 중 하나에 접근하더라도, 니모닉 구문에서 생성된 다른 키에 대한 정보는 얻을 수 없습니다. 소프트 파생 키 기능을 통해 루트 계정의 소유권을 공개하지 않고도 확인할 수 있습니다. 소프트 키는 상위 공개 키를 사용해 파생될 수 있으므로, 부모를 식별하는 데 사용할 수 있습니다.키를 노출하지 않고 상위 시드를 보호합니다.

## Home Assistant에서의 원격 제어

연결 과정을 좀 더 자세히 살펴보겠습니다. 분산형 [Robonomics 애플리케이션](https://robonomics.app/) (또는 DApp)은 브라우저에서 직접 작동하며, 추가 소프트웨어 설치나 다수의 프로그램 환경에서 파일 시스템에 키를 저장할 필요가 없습니다. 이러한 환경에서는 보안을 확신할 수 없습니다. 접근 키 관리는 Polkadot JS 확장 프로그램과 외부 하드웨어 키 저장소(예: [Polkadot Vault](https://wiki.polkadot.network/docs/polkadot-vault))를 통해 수행되어 추가적인 신뢰성을 제공합니다. Robonomics와 상호작용하기 위한 특수 소프트웨어 외에도, DApp에는 경량 libP2P 노드가 포함되어 있어 Home Assistant와의 연결이 이루어집니다.

<RbImage zoom src="/blog/images/secure-robotics-remote-control-via-web3/robonomics_home_assistant_usecase.png" alt="Home Assistant 원격 제어" />

Robonomics Web Service 구독의 소유자는 컨트롤러라고 불리는 계정을 통해 스마트 홈 인프라에 대한 접근 권한을 관리합니다. 이 컨트롤러는 모든 민감한 정보를 암호화된 형태로 디지털 트윈에 저장합니다. 구독에 추가된 사용자만 이 데이터를 복호화할 수 있습니다. 접근 키 외에도, 디지털 트윈에는 DApp 구성과 DApp이 안전한 연결을 위해 접속하는 이른바 libP2P 멀티어드레스도 저장됩니다. 멀티어드레스는 libP2P 접근 방식을 매우 독특하고 유연하게 만드는 혁신 중 하나입니다. 이는 노드의 주소를 위한 특별한 형식으로, 여러 IP 주소, 전송 및 네트워크 식별자, 프로토콜, 포트 등을 포함할 수 있어 특정 노드에 연락할 수 있습니다. 지원되는 프로토콜의 전체 목록은 [명세서](https://github.com/multiformats/multiaddr/blob/master/protocols.csv)에서 확인할 수 있습니다.

따라서, 구독에 추가된 사용자는 Robonomics 디지털 트윈에서 멀티어드레스를 추출하고, 자신만 아는 Peer ID로 안전한 연결을 설정합니다. 성공입니다!

## ROS 2에서의 원격 제어

마찬가지로, Robonomics의 기존 기능을 활용하여 로봇과 상호작용할 수 있습니다. Robonomics Grant Program 하에서 Robossembler 팀은 [Robonomics Bridge](https://gitlab.com/robossembler/robonomics_bridge)라는 개념 증명 프로젝트를 개발했습니다. 이 브리지는당신의 ROS 2 노드를 외부 서비스, 원격 워크스테이션 또는 다른 ROS 2 시스템과 연결할 수 있습니다.

<RbImage zoom src="/blog/images/secure-robotics-remote-control-via-web3/robonomics_ros2_usecase.png" alt="ROS 2 Remote Control with Robonomics" />

*ROS 2의 경우 가정용 로봇의 원격 제어가 어떻게 보일 수 있는지에 대한 예시입니다. 이 접근 방식은 여러 가지 중요한 장점을 제공합니다: 공인 IP가 필요 없고, 네트워크 방화벽(NAT)을 통해서도 로봇에 접근할 수 있으며, 개인 암호화 키가 디스크에 저장되지 않고 안전하게 보호됩니다.*

ROS 2에서 사용되는 프로토콜인 DDS는 노드 상호작용을 위한 유사한 퍼블리셔-서브스크라이버 모델 덕분에 libP2P와 자연스럽게 결합됩니다. Robonomics 브리지를 활용하면 ROS 2 노드와 그 인터페이스(예: eProsima Integration Service를 사용하는 토픽, 서비스, 메시지 타입 등)를 선언적으로 구성할 수 있으며, 이를 통해 외부에서 로봇과의 상호작용이 가능합니다. 또한 원격 컴퓨터에 연결할 때 추가적인 보안 수준을 제공합니다. 상대방의 PeerID를 얻는 메커니즘은 Home Assistant의 경우와 동일하게 Robonomics 노드에서 디지털 트윈 요청을 통해 이루어질 수 있으며, 차이점은 Home Assistant 서버 대신 ROS 2 로봇이, libP2P-websocker-proxy 대신 로봇에 연결된 Robonomics ROS 2 Wrapper가 사용된다는 점입니다.

## 미래의 잠재적 기회

하지만 Web3 기술 기반의 분산 클라우드가 제공할 수 있는 가능성은 이뿐만이 아닙니다. 위에서 설명한 예시에서는 이러한 기술이 원격 컴퓨터 간 메시지 데이터 스트림의 비교적 단순한 전송에 사용되었습니다.

이는 Robonomics 네트워크 스택의 기본 전송 계층이라고 할 수 있으며, 더 복잡한 상위 계층 프로토콜 구현의 기반이 됩니다. SSH와 유사한, 사용자가 자신의 사이버-물리 시스템과 보다 상호작용적으로 소통할 수 있는 방식부터, 자율 로봇 인프라의 다수 사용자가 상호작용하는 애플리케이션 프로토콜에 이르기까지 다양한 확장이 가능합니다.

예를 들어, 특정 제품의 생산 시작 결정은 해당 제품의 잠재 소비자 조직 내에서 경제적 타당성을 고려한 투표와 연계될 수 있습니다. 현재는 어떤 생산을 시작할지에 대한 결정이 투자 메커니즘을 통해 이루어지며, 투자자들은 잠재 수요에 대한 정보를 얻은 후, 미래에 이 수요를 충족시킬 수 있는 개별 기업의 주식을 취득할 수 있습니다.. 만약 소비자들이 신제품 개발과 가격 책정에 더 적극적으로 참여할 수 있다면, 장기적으로는 생산이 소비자들이 네트워크에 제공한 데이터를 바탕으로 수요를 충족시키기 위해 자동으로 재구성되는 운영 방식으로 전환할 수 있습니다.