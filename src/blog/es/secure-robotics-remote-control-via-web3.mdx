---
title: "Control Remoto Seguro de Robótica: Solución Robonomics"
date: 2024-04-19
published: true
locale: 'es'
cover_image: /blog/images/secure-robotics-remote-control-via-web3/remote_control_cover.png
description: "La conexión y el control remoto de tu propio dispositivo inteligente es una función muy popular entre los usuarios. Sin embargo, una tarea tan trivial sigue causando muchas dificultades a los usuarios inexpertos, desde superar el NAT hasta problemas de seguridad. En un nuevo artículo, mostraremos cómo se pueden superar estas dificultades con la ayuda de Robonomics."
related: ['Robonomics Helps Enable Rust for ROS 2', 'Automation: Home meets Industrial']
abstract: "La conexión y el control remoto de tu propio dispositivo inteligente es una función muy popular entre los usuarios. Sin embargo, una tarea tan trivial sigue causando muchas dificultades a los usuarios inexpertos, desde superar el NAT hasta problemas de seguridad. En un nuevo artículo, mostraremos cómo se pueden superar estas dificultades con la ayuda de Robonomics."
tags: ['ROS 2', 'Smart Home']
---

En el artículo anterior, hablamos sobre cómo utilizamos las ventajas de las soluciones industriales en la infraestructura de un hogar inteligente robotizado. Mostramos cómo el framework ROS 2 y su protocolo middleware proporcionan un descubrimiento automático de dispositivos y una interacción intensiva (incluyendo en tiempo real) entre ellos dentro de una red local, lo cual es muy conveniente. Sin embargo, este enfoque es principalmente adecuado para la llamada Zona de Confianza: esa parte de la red informática donde la aparición de actores externos es poco probable. En este caso, confiamos en todos los programas en ejecución y no necesitamos usar cifrado, de la misma manera que no se utiliza dentro de una computadora cuando los programas intercambian datos entre sí.

Pero, ¿qué pasa si necesitas asegurar el funcionamiento de los dispositivos ROS 2 con algún servicio externo o proporcionar acceso remoto a ellos desde el exterior? En esos momentos, surge un problema de seguridad: al obtener acceso a un nodo ROS 2, un servicio externo (y potencialmente una persona malintencionada) esencialmente obtiene acceso a todos los demás nodos; puede escuchar completamente todo el tráfico interno de DDS y acceder a todos los servicios del sistema disponibles.

La clásica disyuntiva entre seguridad y velocidad/conveniencia se resuelve dividiendo el sistema soberano de hogar inteligente en dos partes: segura e insegura.

## Seguridad en ROS 2

Designar una zona con requisitos de seguridad especiales en el espacio de trabajo de los nodos ROS 2 es una tarea bastante compleja. El paquete estándar de seguridad de ROS 2 ([sros2](https://docs.ros.org/es/rolling/Concepts/Intermediate/About-Security.html)) es parte de [ros-core](https://ros.org/reps/rep-2001.html#id32), sobre el cual se construyen todas las distribuciones de ROS 2, y según los desarrolladores principales, está destinado a resolver este problema. Proporciona la capacidad de configurar una infraestructura de clave pública (PKI) relativamente simple dentro de una sola red local. Para cada nodo ROS 2, se establecen políticas de acceso a los datos de otros nodos, así como un conjunto de archivos estándar para tales escenarios: claves criptográficas y certificados. Durante la ejecución del programa, los nodos "ven" solo aquellas fuentes de datos a las que el acceso está explícitamente escrito en la configuración en la etapa de lanzamiento del proyecto. Sin embargo, este enfoque tiene una gran desventaja: todo el tráfico en el sistema está cifrado, lo que puede afectar el rendimiento bajo la carga de red creada por DDS. Será necesario escribir todas las políticas de acceso y generar claves para todos los nodos. Esto es muy difícil de configurar y mantener. Y lo más importante, estamos perdiendo la principal ventaja del Middleware de ROS 2: el rendimiento.

## Puentes

Otra solución es crear los llamados gateways, que transmiten los datos necesarios manteniendo todo lo demás privado. Normalmente, esto se logra utilizando túneles VPN o SSH. Se crea un nodo separado en el espacio de intercambio de datos seguro, que tiene una dirección pública para conexiones externas. En este caso, la gestión de la seguridad se realiza solo a nivel de este nodo (esencialmente una ventana al mundo exterior), sin afectar a los demás. Este enfoque se utiliza en los proyectos [Husarnet](https://github.com/husarnet/husarnet), [DDS Router](https://github.com/eProsima/DDS-Router) y [Zenoh Bridge](https://github.com/eclipse-zenoh/zenoh-plugin-ros2dds), pero también tiene sus desventajas. En este escenario, es necesario establecer un canal de comunicación seguro estrictamente vinculado a la dirección IP o al nombre de dominio de la contraparte. Estos pueden cambiar, ser bloqueados o ser vulnerables a ataques. En la época en que se creó SSH, esto no se consideraba. Además, SSH depende principalmente del sistema de control de acceso del sistema operativo, con todas sus desventajas inherentes.

<RbImage zoom src="/blog/images/secure-robotics-remote-control-via-web3/remote_control_legacy_approach.png" alt="Classic Remote Control via public IP and SSH/VPN" />

*Así es como los usuarios suelen conectarse a sus robots de forma remota hoy en día. Sin embargo, este enfoque tiene algunas desventajas. Requiere una IP pública o/y un nombre DNS, que pueden ser bloqueados en algunos países. También exige el almacenamiento de claves privadas adicionales en ubicaciones potencialmente inseguras (por ejemplo, ~/.ssh).*

SSH, utilizado principalmente por administradores de sistemas y especialistas en TI, requiere conocimientos básicos de la línea de comandos Bash y confianza en el sistema operativo, ya que las claves de cifrado se almacenan directamente en el sistema de archivos o en el agente SSH. La gestión de claves de acceso sigue siendo una tarea bastante compleja para el usuario promedio para mantener una forma segura de proteger sus datos.

## Solución Web3

Como podemos ver, los métodos anteriores no están exentos de inconvenientes, por lo que consideraremos una posible solución al problema utilizando tecnologías de redes peer-to-peer, sobre las cuales está construido Robonomics. En este caso, la nube descentralizada de Robonomics puede verse como una tabla de enrutamiento segura, donde las direcciones de las contrapartes son las claves públicas de los nodos. Necesitas un nodo local de Robonomics y saber qué clave pública tiene tu contraparte, para no depender del sistema DNS (incluidos los registradores de nombres de dominio y servidores) ni del bloqueo de direcciones IP. La biblioteca [libP2P](https://libp2p.io/), que utiliza Robonomics, puede emplear diferentes protocolos de transporte para la entrega de mensajes.

Además, con el avance de las tecnologías Web3, han surgido métodos más eficientes para gestionar información crítica, incluidas las claves privadas. Uno de ellos es la frase mnemotécnica o semilla: un conjunto de 12 o 24 palabras, utilizado para crear cuentas en redes descentralizadas. Este método es conveniente y seguro, ya que la semilla se escribe en un medio externo (por ejemplo, en papel) una sola vez durante la inicialización y se utiliza únicamente para recuperar la cuenta. A partir de la frase mnemotécnica se crea una clave maestra, de la cual se puede generar cualquier jerarquía de claves para diferentes tareas (ver **[Claves determinísticas jerárquicas](https://docs.substrate.io/reference/command-line-tools/subkey/#hierarchical-deterministic-keys)**). Esto simplifica la gestión de claves y su recuperación en caso de pérdida. Si una persona malintencionada obtiene acceso a uno de tus pares de claves, no podrá obtener información sobre otras claves creadas a partir de la frase mnemotécnica. La función de clave derivada suave permite confirmar la propiedad de la cuenta raíz sin revelarla. Debido a que las claves suaves pueden derivarse utilizando la clave pública principal, pueden usarse para identificar al padreclave sin exponer la semilla principal.

## Control remoto en Home Assistant

Examinemos el proceso de conexión con más detalle. La [aplicación descentralizada de Robonomics](https://robonomics.app/) (o simplemente DApp) funciona directamente en tu navegador, no requiere que instales ningún software adicional ni la necesidad de almacenar claves en el sistema de archivos en un entorno con una gran cantidad de programas, cuya seguridad no puedes garantizar. La gestión de claves de acceso se realiza a través de la extensión Polkadot JS, así como con la ayuda de un almacenamiento externo de claves de hardware (por ejemplo, [Polkadot Vault](https://wiki.polkadot.network/docs/polkadot-vault)) para mayor fiabilidad. Además del software especializado para la interacción con Robonomics, la DApp también incluye un nodo libP2P ligero, con el cual se realiza la conexión a Home Assistant.

<RbImage zoom src="/blog/images/secure-robotics-remote-control-via-web3/robonomics_home_assistant_usecase.png" alt="Control Remoto de Home Assistant" />

El propietario de una suscripción a Robonomics Web Service gestiona los derechos de acceso a la infraestructura del hogar inteligente a través de lo que se conoce como un controlador: una cuenta que administra toda la información sensible en forma cifrada en un gemelo digital. Solo los usuarios añadidos a la suscripción pueden descifrar estos datos. Además de las claves de acceso, el Gemelo Digital también almacena la configuración de la DApp y, el llamado, multi-dirección libP2P a la que la DApp se conecta para una conexión segura. La multi-dirección es una de esas innovaciones que hace que el enfoque de libP2P sea tan único y flexible. Este es un formato especial de dirección para nodos, que implica la presencia de muchas direcciones IP, identificadores de transporte y red, protocolos y puertos, a través de los cuales se puede contactar con un nodo específico. La lista completa de protocolos soportados se presenta en la [especificación](https://github.com/multiformats/multiaddr/blob/master/protocols.csv).

Así, el usuario añadido a la suscripción extrae una multi-dirección del gemelo digital de Robonomics y establece una conexión segura con un Peer ID conocido solo por él. ¡Éxito!

## Control remoto en ROS 2

De manera similar, puedes emplear las funciones existentes de Robonomics para interactuar con robots. El equipo de Robossembler, bajo el Programa de Becas de Robonomics, desarrolló un proyecto de Prueba de Concepto conocido como [Robonomics Bridge](https://gitlab.com/robossembler/robonomics_bridge). Este puente permitetus nodos ROS 2 para conectarse con cualquier servicio externo, estación de trabajo remota u otro sistema ROS 2.

<RbImage zoom src="/blog/images/secure-robotics-remote-control-via-web3/robonomics_ros2_usecase.png" alt="Control remoto de ROS 2 con Robonomics" />

*Una ilustración de cómo podría ser el control remoto de un robot doméstico en el caso de ROS 2. Este enfoque ofrece una serie de ventajas significativas: no es necesario tener una IP pública, el acceso al robot está disponible incluso a través de cortafuegos de red (NAT), las claves criptográficas privadas no se almacenan en disco y están protegidas de forma fiable.*

El protocolo utilizado en ROS 2, DDS, se combina de forma natural con libP2P debido a su modelo similar de publicación-suscripción para la interacción entre nodos. Con la ayuda del puente de Robonomics, los nodos ROS 2 y sus interfaces - temas, servicios, tipos de mensajes (por ejemplo, usando el eProsima Integration Service) pueden configurarse de manera declarativa, a través de la cual es posible la interacción con el robot desde el exterior. Esto también permite un nivel adicional de seguridad al conectarse a una computadora remota. El mecanismo para obtener el PeerID de la contraparte puede ser el mismo que en el caso de Home Assistant: a través de una solicitud de Gemelo Digital desde el nodo Robonomics, con la única diferencia de que en lugar del Servidor Home Assistant habrá un robot ROS 2, y en lugar del libP2P-websocker-proxy habrá un Robonomics ROS 2 Wrapper conectado al robot.

## Oportunidades potenciales en el futuro

Sin embargo, estas no son todas las posibilidades que una nube descentralizada basada en tecnologías Web3 puede ofrecer. En el ejemplo descrito anteriormente, estas tecnologías se utilizan para la transmisión relativamente simple de flujos de datos de mensajes entre computadoras remotas.

Esto puede llamarse el nivel de transporte básico en la pila de red de Robonomics, que es la base para la implementación de protocolos de nivel superior más complejos. Desde análogos de SSH, que implican una interacción más interactiva de los usuarios con sus sistemas ciberfísicos, hasta protocolos de aplicación que implican la interacción de un gran número de usuarios de infraestructuras robóticas autónomas.

Por ejemplo, la decisión de iniciar la producción de un determinado producto puede estar vinculada a una votación dentro de una organización de potenciales consumidores de ese producto, considerando la viabilidad económica. Actualmente, la decisión de iniciar cualquier producción se toma a través de mecanismos de inversión, donde los inversores, habiendo recibido información sobre la demanda potencial, pueden adquirir acciones de empresas individuales que puedan satisfacer esa demanda en el futuro.Si los consumidores pueden participar más activamente en el desarrollo y la fijación de precios de nuevos productos, entonces, a largo plazo, podemos pasar a un modo de operación en el que la producción se reestructure automáticamente para satisfacer la demanda según los datos proporcionados por los consumidores a la red.